### ============================================
### Dashboard API Examples
### ============================================

@baseUrl = https://localhost:5219
@tokenEndpoint = {{baseUrl}}/connect/token
@dashboardEndpoint = {{baseUrl}}/api/admin/dashboard

### Variables
@adminUsername = admin@example.com
@adminPassword = Admin@123456

### ============================================
### 1. LOGIN AS ADMIN
### ============================================
# @name adminLogin
POST {{tokenEndpoint}}
Content-Type: application/x-www-form-urlencoded

grant_type=password
&username={{adminUsername}}
&password={{adminPassword}}
&scope=openid profile email roles

### Extract admin token
@adminToken = {{adminLogin.response.body.access_token}}

### ============================================
### 2. GET DASHBOARD STATISTICS
### ============================================
GET {{dashboardEndpoint}}/stats
Authorization: Bearer {{adminToken}}

### Response:
# {
#   "totalUsers": 2,
#   "activeUsers": 1,
#   "activeSessions": 3,
#   "totalClients": 3,
#   "recentRegistrations": 0,
#   "adminCount": 1,
#   "regularUserCount": 0
# }

### ============================================
### 3. GET RECENT ACTIVITIES (Last 10)
### ============================================
GET {{dashboardEndpoint}}/activities
Authorization: Bearer {{adminToken}}

### ============================================
### 4. GET RECENT ACTIVITIES (Last 20)
### ============================================
GET {{dashboardEndpoint}}/activities?limit=20
Authorization: Bearer {{adminToken}}

### ============================================
### 5. TEST WITHOUT PERMISSION (Should Fail)
### ============================================
### First, login as regular user
# @name userLogin
POST {{tokenEndpoint}}
Content-Type: application/x-www-form-urlencoded

grant_type=password
&username=user@example.com
&password=User@123456
&scope=openid profile email roles

### Try to access dashboard (should return 403)
# GET {{dashboardEndpoint}}/stats
# Authorization: Bearer {{userLogin.response.body.access_token}}
